<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="freq_ts extracts the fundamental frequency values as a time series."><title>Extract frequency contours as time series — freq_ts • warbleR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Extract frequency contours as time series — freq_ts"><meta property="og:description" content="freq_ts extracts the fundamental frequency values as a time series."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">warbleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.28</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>vignettes</h6>
    <a class="dropdown-item" href="../articles/Intro_to_warbleR.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;Introduction to warbleR&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_01.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Import sound files and select signals&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_02.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Visual inspection and signal classification&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_03.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Acoustic (dis)similarity, coordinated singing and simulating songs&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/maRce10/warbleR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extract frequency contours as time series</h1>
      <small class="dont-index">Source: <a href="https://github.com/maRce10/warbleR/blob/HEAD/R/freq_ts.R" class="external-link"><code>R/freq_ts.R</code></a></small>
      <div class="d-none name"><code>freq_ts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>freq_ts</code> extracts the fundamental frequency values as a time series.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">freq_ts</span><span class="op">(</span><span class="va">X</span>, type <span class="op">=</span> <span class="st">"dominant"</span>, wl <span class="op">=</span> <span class="fl">512</span>, length.out <span class="op">=</span> <span class="fl">20</span>, wn <span class="op">=</span> <span class="st">"hanning"</span>,</span>
<span>ovlp <span class="op">=</span> <span class="fl">70</span>, bp <span class="op">=</span> <span class="cn">NULL</span>, threshold <span class="op">=</span> <span class="fl">15</span>, img <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="fl">1</span>, path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>img.suffix <span class="op">=</span> <span class="st">"frequency.ts"</span>, pb <span class="op">=</span> <span class="cn">TRUE</span>, clip.edges <span class="op">=</span> <span class="cn">FALSE</span>, leglab <span class="op">=</span> <span class="st">"frequency.ts"</span>,</span>
<span>track.harm <span class="op">=</span> <span class="cn">FALSE</span>, raw.contour <span class="op">=</span> <span class="cn">FALSE</span>, adjust.wl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>ff.method <span class="op">=</span> <span class="st">"seewave"</span>, entropy.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>object of class 'selection_table', 'extended_selection_table' or data
frame containing columns for sound file name (sound.files),
selection number (selec), and start and end time of signal (start and end).</p></dd>


<dt>type</dt>
<dd><p>Character string to determine the type of contour to be detected. Three options are available, "dominant" (default), "fundamental" and "entropy".</p></dd>


<dt>wl</dt>
<dd><p>A numeric vector of length 1 specifying the window length of the spectrogram, default
is 512.</p></dd>


<dt>length.out</dt>
<dd><p>A numeric vector of length 1 giving the number of measurements of fundamental
frequency desired (the length of the time series).</p></dd>


<dt>wn</dt>
<dd><p>Character vector of length 1 specifying window name. Default is
"hanning". See function <code><a href="https://rdrr.io/pkg/seewave/man/ftwindow.html" class="external-link">ftwindow</a></code> for more options.</p></dd>


<dt>ovlp</dt>
<dd><p>Numeric vector of length 1 specifying % of overlap between two
consecutive windows, as in <code><a href="https://rdrr.io/pkg/seewave/man/spectro.html" class="external-link">spectro</a></code>. Default is 70.</p></dd>


<dt>bp</dt>
<dd><p>A numeric vector of length 2 for the lower and upper limits of a
frequency bandpass filter (in kHz). Default is <code>NULL</code>.</p></dd>


<dt>threshold</dt>
<dd><p>amplitude threshold (%) for fundamental frequency detection. Default is 15.</p></dd>


<dt>img</dt>
<dd><p>Logical argument. If <code>FALSE</code>, image files are not produced. Default is <code>TRUE</code>.</p></dd>


<dt>parallel</dt>
<dd><p>Numeric. Controls whether parallel computing is applied.
It specifies the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></dd>


<dt>path</dt>
<dd><p>Character string containing the directory path where the sound files are located.
If <code>NULL</code> (default) then the current working directory is used.</p></dd>


<dt>img.suffix</dt>
<dd><p>A character vector of length 1 with a suffix (label) to add at the end of the names of
image files.</p></dd>


<dt>pb</dt>
<dd><p>Logical argument to control progress bar. Default is <code>TRUE</code>.</p></dd>


<dt>clip.edges</dt>
<dd><p>Logical argument to control whether edges (start or end of signal) in
which amplitude values above the threshold were not detected will be removed. If
<code>TRUE</code> this edges will be excluded and signal contour will be calculated on the
remaining values. Default is <code>FALSE</code>.
#' @param leglab A character vector of length 1 or 2 containing the label(s) of the frequency contour legend
in the output image.</p></dd>


<dt>leglab</dt>
<dd><p>A character vector of length 1 or 2 containing the label(s) of the frequency contour legend
in the output image.</p></dd>


<dt>track.harm</dt>
<dd><p>Logical. If <code>TRUE</code> warbleR's <code><a href="track_harmonic.html">track_harmonic</a></code> function is
used to track dominant frequency contours. Otherwise seewave's <code><a href="https://rdrr.io/pkg/seewave/man/dfreq.html" class="external-link">dfreq</a></code> is used by default. Default is <code>FALSE</code>.</p></dd>


<dt>raw.contour</dt>
<dd><p>Logical. If <code>TRUE</code> then a list with the original contours
(i.e. without interpolating values to make all contours of equal length) is returned (and no images are produced).</p></dd>


<dt>adjust.wl</dt>
<dd><p>Logical. If <code>TRUE</code> 'wl' (window length) is reset to be lower than the
number of samples in a selection if the number of samples is less than 'wl'. Default is <code>TRUE</code>. Used only for dominant frequency detection.</p></dd>


<dt>ff.method</dt>
<dd><p>Character. Selects the method used to detect fundamental
frequency contours. Either 'tuneR' (using <code><a href="https://rdrr.io/pkg/tuneR/man/FF.html" class="external-link">FF</a></code>) or 'seewave' (using
<code><a href="https://rdrr.io/pkg/seewave/man/fund.html" class="external-link">fund</a></code>). Default is 'seewave'. 'tuneR' performs
faster (and seems to be more accurate) than 'seewave'.</p></dd>


<dt>entropy.range</dt>
<dd><p>Numeric vector of length 2. Range of frequency in which to display the entropy values
on the spectrogram (when img = TRUE). Default is c(2, 10). Negative values can be used in order to stretch more
the range.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to <code><a href="track_freq_contour.html">track_freq_contour</a></code>. for customizing
graphical output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame with the fundamental frequency values measured across the signals. If img is
<code>TRUE</code> it also produces image files with the spectrograms of the signals listed in the
input data frame showing the location of the fundamental frequencies
(see <code><a href="track_freq_contour.html">track_freq_contour</a></code> description for more details).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function extracts the dominant frequency, fundamental frequency or spectral entropy contours as time series.
The function uses the <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></code> function to interpolate values between frequency measures. If there are no frequencies above the amplitude threshold (for dominant and fundamental) at the beginning or end
 of the signals then NAs will be generated. On the other hand, if there are no frequencies
 above the amplitude theshold in between signal segments in which amplitude was
 detected then the values of this adjacent segments will be interpolated
 to fill out the missing values (e.g. no NAs in between detected amplitude segments).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sig2noise.html">sig2noise</a></code>, <code><a href="track_freq_contour.html">track_freq_contour</a></code>, <code>freq_ts</code>, <code><a href="freq_DTW.html">freq_DTW</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marcelo Araya-Salas (<a href="mailto:marcelo.araya@ucr.ac.cr">marcelo.araya@ucr.ac.cr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="op">{</span></span>
<span><span class="co">#load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phae.long1"</span>, <span class="st">"Phae.long2"</span>,<span class="st">"lbh_selec_table"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long1</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Phae.long1.wav"</span><span class="op">)</span><span class="op">)</span> <span class="co">#save sound files</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long2</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Phae.long2.wav"</span><span class="op">)</span><span class="op">)</span> <span class="co">#save sound files</span></span>
<span></span>
<span><span class="co"># run function with dominant frequency</span></span>
<span><span class="fu">freq_ts</span><span class="op">(</span>X <span class="op">=</span> <span class="va">lbh_selec_table</span>, length.out <span class="op">=</span> <span class="fl">30</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>wl <span class="op">=</span> <span class="fl">300</span>, pb <span class="op">=</span> <span class="cn">FALSE</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># note a NA in the row 4 column 3 (dfreq-1)</span></span>
<span><span class="co"># this can be removed by clipping edges (removing NAs at the start and/or end</span></span>
<span><span class="co"># when no freq was detected)</span></span>
<span></span>
<span><span class="fu">freq_ts</span><span class="op">(</span>X <span class="op">=</span> <span class="va">lbh_selec_table</span>, length.out <span class="op">=</span> <span class="fl">30</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>wl <span class="op">=</span> <span class="fl">300</span>, pb <span class="op">=</span> <span class="cn">FALSE</span>, clip.edges <span class="op">=</span> <span class="cn">TRUE</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run function with fundamental frequency</span></span>
<span><span class="fu">freq_ts</span><span class="op">(</span><span class="va">lbh_selec_table</span>, type <span class="op">=</span> <span class="st">"fundamental"</span>, length.out <span class="op">=</span> <span class="fl">50</span>,</span>
<span>flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>,  bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>, wl <span class="op">=</span> <span class="fl">300</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run function with spectral entropy</span></span>
<span><span class="co"># without clip edges</span></span>
<span><span class="fu">freq_ts</span><span class="op">(</span>X <span class="op">=</span> <span class="va">lbh_selec_table</span>, type <span class="op">=</span> <span class="st">"entropy"</span>, threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>clip.edges <span class="op">=</span> <span class="cn">FALSE</span>, length.out <span class="op">=</span> <span class="fl">10</span>, sp.en.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span> img <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># with clip edges and length.out 10</span></span>
<span><span class="fu">freq_ts</span><span class="op">(</span>X <span class="op">=</span> <span class="va">lbh_selec_table</span>, type <span class="op">=</span> <span class="st">"entropy"</span>, threshold <span class="op">=</span> <span class="fl">10</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>clip.edges <span class="op">=</span> <span class="cn">TRUE</span>, length.out <span class="op">=</span> <span class="fl">10</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, img <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

