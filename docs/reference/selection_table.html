<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create 'selection_table' and 'extended_selection_table' objects — selection_table • warbleR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Create 'selection_table' and 'extended_selection_table' objects — selection_table" />
<meta property="og:description" content="selection_table converts data frames into an object of classes 'selection_table' or 'extended_selection_table'." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">warbleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.28</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">vignettes</li>
    <li>
      <a href="../articles/Intro_to_warbleR.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;Introduction to warbleR&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_01.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Import sound files and select signals&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_02.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Visual inspection and signal classification&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
    <li>
      <a href="../articles/warbleR_workflow_03.html">&lt;center&gt;&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Acoustic (dis)similarity, coordinated singing and simulating songs&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maRce10/warbleR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create 'selection_table' and 'extended_selection_table' objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/maRce10/warbleR/blob/master/R/selection_table.R'><code>R/selection_table.R</code></a></small>
    <div class="hidden name"><code>selection_table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>selection_table</code> converts data frames into an object of classes 'selection_table' or 'extended_selection_table'.</p>
    </div>

    <pre class="usage"><span class='fu'>selection_table</span><span class='op'>(</span><span class='va'>X</span>, max.dur <span class='op'>=</span> <span class='fl'>10</span>, path <span class='op'>=</span> <span class='cn'>NULL</span>, whole.recs <span class='op'>=</span> <span class='cn'>FALSE</span>,
extended <span class='op'>=</span> <span class='cn'>FALSE</span>, confirm.extended <span class='op'>=</span> <span class='cn'>TRUE</span>, mar <span class='op'>=</span> <span class='fl'>0.1</span>, by.song <span class='op'>=</span> <span class='cn'>NULL</span>, 
pb <span class='op'>=</span> <span class='cn'>TRUE</span>, parallel <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, skip.error <span class='op'>=</span> <span class='cn'>FALSE</span>, 
file.format <span class='op'>=</span> <span class='st'>"\\.wav$|\\.wac$|\\.mp3$|\\.flac$"</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>data frame with the following columns: 1) "sound.files": name of the .wav 
files, 2) "selec": unique selection identifier (within a sound file), 3) "start": start time and 4) "end": 
end time of selections. Columns for 'top.freq', 'bottom.freq' and 'channel' are optional. Note that, when 'channel' is
not provided the first channel (i.e. left channel) would be used by default. 
Frequency parameters (including top and bottom frequency) should be provided in kHz. Alternatively, a 'selection_table' class object can be input.</p></td>
    </tr>
    <tr>
      <th>max.dur</th>
      <td><p>the maximum duration of expected for a selection  (ie. end - start). If surpassed then an error message 
will be generated. Useful for detecting errors in selection tables.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Character string containing the directory path where the sound files are located. 
If <code>NULL</code> (default) then the current working directory is used.</p></td>
    </tr>
    <tr>
      <th>whole.recs</th>
      <td><p>Logical. If <code>TRUE</code> the function will create a selection 
table for all sound files in the working directory (or "path") with `start = 0` 
and `end = duration_wavs()`. Default is if <code>FALSE</code>. Note that this will not create
a extended selection table. If provided 'X' is ignored.</p></td>
    </tr>
    <tr>
      <th>extended</th>
      <td><p>Logical. If <code>TRUE</code>, the function will create an object of class 'extended_selection_table' 
which included the wave objects of the selections as an additional attribute ('wave.objects') to the data set. This is 
and self-contained format that does not require the original sound files for running most acoustic analysis in 
<code><a href='warbleR.html'>warbleR</a></code>. This can largely facilitate the storing and sharing of (bio)acoustic data. Default 
is if <code>FALSE</code>. An extended selection table won't be created if there is any issue with the selection. See 
'details'.</p></td>
    </tr>
    <tr>
      <th>confirm.extended</th>
      <td><p>Logical. If <code>TRUE</code> then the size of the 'extended_selection_table' 
will be estimated and the user will be asked for confirmation (in the console)
before proceeding. Ignored if 'extended' is <code>FALSE</code>. This is used to prevent
generating objects too big to be dealt with by R. See 'details' for more information about extended selection table size.</p></td>
    </tr>
    <tr>
      <th>mar</th>
      <td><p>Numeric vector of length 1 specifying the margins (in seconds) 
adjacent to the start and end points of the selections when creating extended 
selection tables. Default is 0.1. Ignored if 'extended' is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>by.song</th>
      <td><p>Character string with the column name containing song labels. If provided a wave object containing for 
all selection belonging to a single song would be saved in the extended selection table (hence only applicable for 
extended selection tables). Note that the function assumes that song labels are not repeated within a sound file. 
If <code>NULL</code> (default), wave objects are created for each selection (e.g. by selection). 
Ignored if <code>extended = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>pb</th>
      <td><p>Logical argument to control progress bar and messages. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Numeric. Controls whether parallel computing is applied.
It specifies the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical argument to control if summary messages are printed to the console. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>skip.error</th>
      <td><p>Logical to control if errors are omitted. If so, files that could not be read will be excluded and their name printed in the console. Default is <code>FALSE</code>, which will return an error if some files are problematic.</p></td>
    </tr>
    <tr>
      <th>file.format</th>
      <td><p>Character string with the format of sound files. By default all sound file formats supported by warbleR are included ("\.wav$|\.wac$|\.mp3$|\.flac$"). Note that several formats can be included using regular expression syntax as in <code><a href='https://rdrr.io/r/base/grep.html'>grep</a></code>. For instance <code>"\.wav$|\.mp3$"</code> will only include .wav and .mp3 files. Ignored if <code>whole.recs = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to <code><a href='check_sels.html'>check_sels</a></code> for customizing
checking routine.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class selection_table which includes the original data frame plus the following additional attributes:</p><ul>
<li><p>1) A data frame with the output of <code><a href='check_sels.html'>check_sels</a></code> run on the input data frame. If a extended selection table is created it will also include the original values in the input data frame for each selections. This are used by downstream warbleR functions to improve efficiency and avoid
errors due to missing or mislabeled data, or selection out of the ranges of the original sound files.</p></li>
<li><p>2) A list indicating if the selection table has been created by song (see 'by.song argument).</p></li>
<li><p>3) If a extended selection table is created a list containing the wave objects for each selection (or song if 'by.song').</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function creates and object of class 'selection_table' or 'extended_selection_table' (if <code>extended = TRUE</code>, see below). First, the function checks:</p><ul>
<li><p>1) if the selections listed in the data frame correspond to .wav files
in the working directory</p></li>
<li><p>2) if the sound files can be read and if so,</p></li>
<li><p>3) if the start and end time of the selections are found within the duration of the sound files</p></li>
</ul><p>If no errors are found the a selection table or extended selection table will be generated. 
Note that the sound files should be in the working directory (or the directory provided in 'path').
This is useful for avoiding errors in downstream functions (e.g. <code><a href='spectro_analysis.html'>spectro_analysis</a></code>, <code><a href='cross_correlation.html'>cross_correlation</a></code>,  <code><a href='catalog.html'>catalog</a></code>, <code><a href='freq_DTW.html'>freq_DTW</a></code>). Note also that corrupt files can be
fixed using <code><a href='fix_wavs.html'>fix_wavs</a></code> ('sox' must be installed to be able to run this function).
The 'selection_table' class can be input in subsequent functions.</p>
<p>When <code>extended = TRUE</code> the function will generate an object of class 'extended_selection_table' which 
will also contains the wave objects for each of the selections in the data frame.
This transforms selection tables into self-contained objects as they no longer need the original
sound files to run acoustic analysis. This can largely facilitate the storing and sharing of (bio)acoustic data.
Extended selection table size will be a function of the number of selections <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(X)</a></code>, sampling rate, selection 
duration and margin duration. As a guide, a selection table
with 1000 selections similar to the ones in 'lbh_selec_table' (mean duration ~0.15
 seconds) at 22.5 kHz sampling rate and the default margin (<code>mar = 0.1</code>) 
 will generate a extended selection table of ~31 MB (~310 MB for a 10000 rows 
 selection table). You can check the size of the output extended selection table
 with the <code><a href='https://rdrr.io/r/utils/object.size.html'>object.size</a></code> function. Note that extended selection table created 'by.song' could be 
 considerable larger.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M., &amp; Smith-Vidaurre, G. (2017). warbleR: An R package to streamline analysis of animal acoustic signals. Methods in Ecology and Evolution, 8(2), 184-191.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='check_wavs.html'>check_wavs</a></code>, <a href='https://marce10.github.io/2018/05/15/Extended_selection_tables.html'>blog post on extended selection tables</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marcelo Araya-Salas (<a href='mailto:marcelo.araya@ucr.ac.cr'>marcelo.araya@ucr.ac.cr</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span>list <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Phae.long1"</span>, <span class='st'>"Phae.long2"</span>, <span class='st'>"Phae.long3"</span>, <span class='st'>"Phae.long4"</span>, 
<span class='st'>"lbh_selec_table"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>writeWave</span><span class='op'>(</span><span class='va'>Phae.long1</span>, <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Phae.long1.wav"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>writeWave</span><span class='op'>(</span><span class='va'>Phae.long2</span>, <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Phae.long2.wav"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>writeWave</span><span class='op'>(</span><span class='va'>Phae.long3</span>, <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Phae.long3.wav"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>writeWave</span><span class='op'>(</span><span class='va'>Phae.long4</span>, <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"Phae.long4.wav"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># make selection table</span>
<span class='va'>st</span> <span class='op'>&lt;-</span> <span class='fu'>selection_table</span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>lbh_selec_table</span>, path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='is_selection_table.html'>is_selection_table</a></span><span class='op'>(</span><span class='va'>st</span><span class='op'>)</span>

<span class='co'>#' # make extended selection table</span>
<span class='va'>st</span> <span class='op'>&lt;-</span> <span class='fu'>selection_table</span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>lbh_selec_table</span>, extended <span class='op'>=</span> <span class='cn'>TRUE</span>, 
confirm.extended <span class='op'>=</span> <span class='cn'>FALSE</span>, 
path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='is_extended_selection_table.html'>is_extended_selection_table</a></span><span class='op'>(</span><span class='va'>st</span><span class='op'>)</span>

<span class='co'>### make extended selection by song  </span>
<span class='co'># create a song variable</span>
<span class='va'>lbh_selec_table</span><span class='op'>$</span><span class='va'>song</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>lbh_selec_table</span><span class='op'>$</span><span class='va'>sound.files</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>st</span> <span class='op'>&lt;-</span> <span class='fu'>selection_table</span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>lbh_selec_table</span>, extended <span class='op'>=</span> <span class='cn'>TRUE</span>, 
confirm.extended <span class='op'>=</span> <span class='cn'>FALSE</span>, by.song <span class='op'>=</span> <span class='st'>"song"</span>, path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


