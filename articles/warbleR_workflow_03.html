<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="warbleR">
<title>
<font size="7"><b>warbleR: Acoustic (dis)similarity, coordinated singing and simulating songs</b></font> • warbleR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="&lt;font size=">
</head>
<body>
<b>warbleR: Acoustic (dis)similarity, coordinated singing and simulating songs</b>" /&gt;
<meta property="og:description" content="warbleR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">warbleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.29</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>vignettes</h6>
    <a class="dropdown-item" href="../articles/Intro_to_warbleR.html">&lt;font size="7"&gt;&lt;b&gt;Introduction to warbleR&lt;/b&gt;&lt;/font&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_01.html">&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Import sound files and select signals&lt;/b&gt;&lt;/font&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_02.html">&lt;font size="7"&gt;&lt;b&gt;"warbleR&amp;#58; Visual inspection and signal classification&lt;/b&gt;&lt;/font&gt;</a>
    <a class="dropdown-item" href="../articles/warbleR_workflow_03.html">&lt;font size="7"&gt;&lt;b&gt;warbleR&amp;#58; Acoustic (dis)similarity, coordinated singing and simulating songs&lt;/b&gt;&lt;/font&gt;</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/maRce10/warbleR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><font size="7"><b>warbleR: Acoustic (dis)similarity, coordinated singing and simulating songs</b></font></h1>
                        <h4 data-toc-skip class="author"><a href="https://marceloarayasalas.weebly.com" class="external-link">Marcelo
Araya-Salas, PhD</a></h4>
                        <h4 data-toc-skip class="author">
<a href="https://smith-vidaurre.com/" class="external-link">Grace
Smith-Vidaurre</a>  </h4>
            
            <h4 data-toc-skip class="date">2023-08-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/maRce10/warbleR/blob/HEAD/vignettes/warbleR_workflow_03.Rmd" class="external-link"><code>vignettes/warbleR_workflow_03.Rmd</code></a></small>
      <div class="d-none name"><code>warbleR_workflow_03.Rmd</code></div>
    </div>

    
    
<!-- <center> <h1><b>Acoustic (dis)similarity and coordinated singing</h1></b> </center> -->
<!-- <center> <i><font size="4">Marcelo Araya-Salas and Grace Smith Vidaurre</font></i> </center> -->
<!-- <center> 2023-08-31 </center> -->
<style type="text/css">
div#header h1.title, div#header h3.subtitle, div#header h4.author, div#header h4.date {
  text-align: center
}
</style>
<div class="section level2">
<h2 id="bioacoustics-in-r-with-warbler">Bioacoustics in R with <code>warbleR</code><a class="anchor" aria-label="anchor" href="#bioacoustics-in-r-with-warbler"></a>
</h2>
<p><img src="warbleR_sticker.png" alt="warbleR logo" align="right" width="25%" height="25%"></p>
<p>Bioacoustics research encompasses a wide range of questions, study
systems and methods, including the software used for analyses. The
<code>warbleR</code> and <code>Rraven</code> packages leverage the
flexibility of the <code>R</code> environment to offer a broad and
accessible bioinformatics tool set. These packages fundamentally rely
upon two types of data to begin bioacoustic analyses in R:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Sound files:</strong> Recordings in <em>wav</em> or
<em>mp3</em> format, either from your own research or open-access
databases like <em>xeno-canto</em></p></li>
<li><p><strong>Selection tables:</strong> Selection tables contain the
temporal coordinates (start and end points) of selected acoustic signals
within recordings</p></li>
</ol>
<div class="section level3">
<h3 id="package-repositories">Package repositories<a class="anchor" aria-label="anchor" href="#package-repositories"></a>
</h3>
<p>These packages are both available on <em>CRAN</em>: <a href="https://cran.r-project.org/package=warbleR" class="external-link"><code>warbleR</code></a>,
<a href="https://cran.r-project.org/package=Rraven" class="external-link"><code>Rraven</code></a>,
as well as on <em>GitHub</em>: <a href="https://github.com/maRce10/warbleR" class="external-link"><code>warbleR</code></a>, <a href="https://github.com/maRce10/Rraven" class="external-link"><code>Rraven</code></a>. The
GitHub repository will always contain the latest functions and updates.
You can also check out an article in <em>Methods in Ecology and
Evolution</em> documenting the <code>warbleR</code> package
<a href="#References"><sup>[1]</sup></a>.</p>
<p>We welcome all users to provide feedback, contribute updates or new
functions and report bugs to warbleR’s GitHub repository.</p>
<p>Please note that <code>warbleR</code> and <code>Rraven</code> use
functions from the <a href="https://cran.r-project.org/package=seewave" class="external-link"><code>seewave</code></a>,
<a href="https://cran.r-project.org/package=monitoR" class="external-link"><code>monitoR</code></a>,
<a href="https://cran.r-project.org/package=tuneR" class="external-link"><code>tuneR</code></a>
and <a href="https://cran.r-project.org/package=dtw" class="external-link"><code>dtw</code></a>
packages internally. <code>warbleR</code> and <code>Rraven</code> have
been designed to make bioacoustics analyses more accessible to
<code>R</code> users, and such analyses would not be possible without
the tools provided by the packages above. These packages should be given
credit when using <code>warbleR</code> and <code>Rraven</code> by
including citations in publications as appropriate
(e.g. <code>citation("seewave")</code>).</p>
</div>
<div class="section level3">
<h3 id="parallel-processing-in-warbler">Parallel processing in <code>warbleR</code><a class="anchor" aria-label="anchor" href="#parallel-processing-in-warbler"></a>
</h3>
<p>Parallel processing, or using multiple cores on your machine, can
greatly speed up analyses. All iterative <code>warbleR</code> functions
now have parallel processing for Linux, Mac and Windows operating
systems. These functions also contain progress bars to visualize
progress during normal or parallel processing. See
<a href="#References"><sup>[1]</sup></a> for more details about improved
running time using parallel processing.</p>
</div>
</div>
<div class="section level2">
<h2 id="vignette-introduction">
<strong>Vignette introduction</strong><a class="anchor" aria-label="anchor" href="#vignette-introduction"></a>
</h2>
<p>In the previous vignette, we performed quality control processing of
selected signals and made lexicons for visual classification. Here we
continue with the case study of microgeographic vocal variation in
long-billed hermit hummingbirds, <em>Phaethornis longirostris</em>
<a href="#References"><sup>[2]</sup></a> (and a short sidenote using
<em>Tinamus major</em> for an example of a tonal signal) by:</p>
<ol style="list-style-type: decimal">
<li><p>Detecting signal frequency range</p></li>
<li><p>Extracting spectral entropy and frequency contours as time
series</p></li>
<li>
<p>Comparing methods for quantitative analysis of signal
structure</p>
<ul>
<li>data set of 29 acoustic parameters</li>
<li>spectrographic cross-correlation</li>
<li>dynamic time warping on frequency contours</li>
</ul>
</li>
<li><p>Visually inspecting frequency contours</p></li>
<li><p>Measuring acoustic parameters as a batch-process across
signals</p></li>
<li><p>Calculating pairwise acoustic (dis)similarity between
signals</p></li>
<li><p>Analysis of geographic variation in <em>Phaethornis
longirostris</em> songs</p></li>
</ol>
<p>We also include some examples at the end of the vignette of how to
perform coordinated singing analysis and simulate songs.</p>
<p>This vignette can be run without an advanced understanding of
<code>R</code>, as long as you know how to run code in your console.
However, knowing more about basic <code>R</code> coding would be very
helpful to modify the code for your research questions.</p>
<p>For more details about function arguments, input or output, read the
documentation for the function in question
(e.g. <code><a href="../reference/cross_correlation.html">?cross_correlation</a></code>).  </p>
</div>
<div class="section level2">
<h2 id="prepare-for-analyses">
<strong>Prepare for analyses</strong><a class="anchor" aria-label="anchor" href="#prepare-for-analyses"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marce10.github.io/warbleR/">warbleR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set your working directory appropriately</span></span>
<span><span class="co"># setwd("/path/to/working directory")</span></span>
<span></span>
<span><span class="co"># run this if you have restarted RStudio between vignettes without saving your workspace</span></span>
<span><span class="co"># assumes that you are in your /home/username directory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"warbleR_example"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check your location</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This vignette series will not always include all available
<code>warbleR</code> functions, as existing functions are updated and
new functions are added. To see all functions available in this
package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The package must be loaded in your working environment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="st">"package:warbleR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-acoustic-parameters-as-time-series">
<strong>Extract acoustic parameters as time series</strong><a class="anchor" aria-label="anchor" href="#extract-acoustic-parameters-as-time-series"></a>
</h2>
<div class="section level3">
<h3 id="detect-frequency-range">Detect frequency range<a class="anchor" aria-label="anchor" href="#detect-frequency-range"></a>
</h3>
<p><em>Raven</em> selection tables can return low and high frequencies
in your selections (e.g. if <code>all.data</code> or
<code>freq.cols</code> in <code>run_raven</code> or
<code>imp.raven</code> is TRUE), but the accuracy of these frequency
selections depends on how the signals themselves were selected. Below we
demonstrate how to visualize and detect the frequency range in your
selected signals using the functions <code>freq_range_detec</code> and
<code>freq_range</code>, which have options for setting bandpass filters
to exclude background noise or other non-target acoustic signals.</p>
<p><code>freq_range_detec</code> creates a plot that will print to your
graphics device, and also outputs a data frame per recording with the
frequency range. This data frame can be used in subsequent analyses if
saved as an object. <code>freq_range_detec</code> works best with single
signals. If used for a whole recording, <code>freq_range_detec</code>
will pick up <em>all</em> sounds in the recording.</p>
<p>Finally, although we have been using <em>Phaethornis
longirostris</em> vocalizations throughout these vignettes, these
signals are harmonically structured. The functions for detecting
frequency ranges, <code>freq_range</code> and
<code>freq_range_detec</code> work best on tonal signals, so for this
example we will use Great Tinamou ( <em>Tinamus major</em>) songs.</p>
<p>Download a tinamou recording from <em>xeno-canto</em>, make
selections and visualize/detect frequency ranges.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_xc.html">query_xc</a></span><span class="op">(</span>qword <span class="op">=</span> <span class="st">"Tinamus"</span>, download <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select a single recording</span></span>
<span><span class="va">tin</span> <span class="op">&lt;-</span> <span class="va">tin</span><span class="op">[</span><span class="va">tin</span><span class="op">$</span><span class="va">Recordist</span> <span class="op">==</span> <span class="st">"Marcelo Araya-Salas"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># download this recording</span></span>
<span><span class="fu"><a href="../reference/query_xc.html">query_xc</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">tin</span>, download <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/mp32wav.html">mp32wav</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here we will use a data set with sound files that have been already annotated</span></span>
<span><span class="co"># read the selections back into the global environment</span></span>
<span><span class="va">Tin.sels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"manualoc_output.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Tin.sels</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cut the original wave file by selections for freq_range_detec below</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/cutw.html" class="external-link">cutw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html" class="external-link">readWave</a></span><span class="op">(</span><span class="st">"Tinamus-major-154191.wav"</span><span class="op">)</span>, from <span class="op">=</span> <span class="va">Tin.sels</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">Tin.sels</span><span class="op">$</span><span class="va">end</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, f <span class="op">=</span> <span class="fl">44100</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, output <span class="op">=</span> <span class="st">"Wave"</span><span class="op">)</span>, filename <span class="op">=</span> <span class="st">"Tinamus-major-154191-1.wav"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/cutw.html" class="external-link">cutw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html" class="external-link">readWave</a></span><span class="op">(</span><span class="st">"Tinamus-major-154191.wav"</span><span class="op">)</span>, from <span class="op">=</span> <span class="va">Tin.sels</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">Tin.sels</span><span class="op">$</span><span class="va">end</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, f <span class="op">=</span> <span class="fl">44100</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, output <span class="op">=</span> <span class="st">"Wave"</span><span class="op">)</span>, filename <span class="op">=</span> <span class="st">"Tinamus-major-154191-2.wav"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># note that changing the threshold argument in combination with the bandpass argument can improve the detection</span></span>
<span><span class="fu"><a href="../reference/freq_range_detec.html">freq_range_detec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html" class="external-link">readWave</a></span><span class="op">(</span><span class="st">"Tinamus-major-154191-1.wav"</span><span class="op">)</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">15</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here, giving a strict bandpass with very low threshold improves freq_range detection</span></span>
<span><span class="co"># since the curving end of the tinamou signal is lower amplitude than the rest of the signal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html" class="external-link">readWave</a></span><span class="op">(</span><span class="st">"Tinamus-major-154191-1.wav"</span><span class="op">)</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The function <code>freq_range</code> allows you to simultaneously
return the frequency ranges for all signals in a selection table,
including the graphical output as <code>freq_range_detec</code>. Check
out the resulting image file in your graphics device. In addition to
image files, this function returns the original selection table, as a
data frame with the newly calculated low and high frequency
measurements.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use arguments from freq_range_detec above</span></span>
<span><span class="va">fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/freq_range.html">freq_range</a></span><span class="op">(</span><span class="va">Tin.sels</span>, threshold <span class="op">=</span> <span class="fl">1</span>, res <span class="op">=</span> <span class="fl">100</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-spectral-entropy-as-a-time-series">Extract spectral entropy as a time series<a class="anchor" aria-label="anchor" href="#extract-spectral-entropy-as-a-time-series"></a>
</h3>
<p>Spectral entropy can be calculated as time series in selected signals
and plotted onto image files. Previously, spectral entropy was only
available as a sole measurement across a selection, as measured by
<code>spectro_analysis</code>. Check out the resulting image files in
your working directory.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Phae.hisnrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Phae_hisnrt.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">entropy_ts</span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, length.out <span class="op">=</span> <span class="fl">10</span>, threshold <span class="op">=</span> <span class="fl">10</span>, img <span class="op">=</span> <span class="cn">TRUE</span>, img.suffix <span class="op">=</span> <span class="st">"entropy_ts"</span>, type <span class="op">=</span> <span class="st">"b"</span>, ovlp <span class="op">=</span> <span class="fl">90</span>, sp.en.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, picsize <span class="op">=</span> <span class="fl">0.75</span>, title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="visualizing-frequency-contours-with-track_freq_contour">Visualizing frequency contours with
<code>track_freq_contour</code><a class="anchor" aria-label="anchor" href="#visualizing-frequency-contours-with-track_freq_contour"></a>
</h4>
<p>The function <code>track_freq_contour</code> allows you to create
spectrograms and visualize the accuracy of dominant frequency and
fundamental frequency measurements.</p>
<p>Use <code>track_freq_contour</code> on all the recordings for which
you want to extract frequency contours as a time series, or later,
calculate other frequency measurements. Scroll through all the
spectrograms to get a feeling for how well the frequency measurements
will be performed across your recordings.</p>
<p>Running <code>track_freq_contour</code> can allow you to decide which
frequency parameters to use in subsequent analyses, namely
<code>spectro_analysis</code> and dynamic time warping methods. Also, ff
the frequency measurements look acceptable with the bandpass setting
used in <code>track_freq_contour</code>, use that same bandpass while
running <code>spectro_analysis</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that the dominant frequency measurements are almost always more accurate</span></span>
<span><span class="fu"><a href="../reference/track_freq_contour.html">track_freq_contour</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>, it <span class="op">=</span> <span class="st">"jpeg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We can change the lower end of bandpass to make the frequency measurements more precise</span></span>
<span><span class="fu"><a href="../reference/track_freq_contour.html">track_freq_contour</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>, <span class="st">"orange"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">3</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">100</span>, it <span class="op">=</span> <span class="st">"jpeg"</span>, picsize <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<!-- <center> ![track_freq_contour image](Phaethornis-longirostris-154072.wav-108-trackfreqs.jpeg)</center> -->
<p> </p>
<p>Note that the fundamental frequency measurements are not always very
accurate, so we will remove fundamental frequency measurements later
on.</p>
</div>
</div>
<div class="section level3">
<h3 id="extract-fundamental-or-dominant-frequency-contours-as-a-time-series">Extract fundamental or dominant frequency contours as a time
series<a class="anchor" aria-label="anchor" href="#extract-fundamental-or-dominant-frequency-contours-as-a-time-series"></a>
</h3>
<p>These functions return a data frame that contains estimated frequency
contours as a time series across each signal in the input data frame.
You can also specify if you want to create image files with the
estimated frequency contours plotted over spectrograms. You can change
argument settings to better visualize the signals or change the
estimation of the frequency contour. For instance, the argument
<code>threshold</code> (as in <code>auto_detec</code>) controls the
amplitude threshold for estimating frequency values at each time point.
Note that the fundamental frequency contour estimation can often have
errors, and tends to perform best with more tonal signals. The frequency
contours are those that can be visualized using
<code>track_freq_contour</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fundamental frequency contour</span></span>
<span><span class="va">ff_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/freq_ts.html">freq_ts</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, length.out <span class="op">=</span> <span class="fl">20</span>, threshold <span class="op">=</span> <span class="fl">15</span>, img <span class="op">=</span> <span class="cn">TRUE</span>, img.suffix <span class="op">=</span> <span class="st">"ff"</span>, type <span class="op">=</span> <span class="st">"p"</span>, ovlp <span class="op">=</span> <span class="fl">70</span>, clip.edges <span class="op">=</span> <span class="cn">FALSE</span>, leglab <span class="op">=</span> <span class="st">"freq_ts"</span>, ff.method <span class="op">=</span> <span class="st">"tuneR"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ff_df</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dominant frequency contour</span></span>
<span></span>
<span><span class="co"># Uses seewave function dfreq by default</span></span>
<span><span class="va">df_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/freq_ts.html">freq_ts</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, length.out <span class="op">=</span> <span class="fl">20</span>, threshold <span class="op">=</span> <span class="fl">15</span>, img <span class="op">=</span> <span class="cn">TRUE</span>, img.suffix <span class="op">=</span> <span class="st">"ff"</span>, type <span class="op">=</span> <span class="st">"p"</span>, ovlp <span class="op">=</span> <span class="fl">70</span>, clip.edges <span class="op">=</span> <span class="cn">FALSE</span>, leglab <span class="op">=</span> <span class="st">"freq_ts"</span>, fsmooth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df_df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="manually-tailor-frequency-contours-with-tailor_sels">Manually tailor frequency contours with tailor_sels<a class="anchor" aria-label="anchor" href="#manually-tailor-frequency-contours-with-tailor_sels"></a>
</h3>
<p>The functions above to track/extract dominant and fundamental
frequency contours perform best with more tonal signals. The frequency
measurements for signals with harmonic structure tend to jump around,
and might not always match your own visual tracking of frequency
contours. If this is the case, you can use the function
<code>tailor_sels</code> to fix frequency contours where individual
frequency measurements are clearly far off from the frequency contour
detected by the human eye. The <code>tailor_sels</code> function is the
same used in vignette 2 in this series, but by changing a few arguments,
you can use <code>tailor_sels</code> to fix frequency contours.</p>
<p>Note that manually fixing frequency contours might not make sense,
depending on your question and/or the contour in question. For instance,
a dominant frequency contour for a harmonic signal that jumps around and
does not form a smooth contour may in fact be the truth, rather than
mis-estimation of the contour. On the other hand, fundamental
frequencies can be more easily traced by the human eye across a signal,
so using <code>tailor_sels</code> to fix a frequency contour that jumps
around the signal makes more sense.</p>
<p>When the new graphics window for <code>tailor_sels</code> appears, it
will show spectrograms as we saw in vignette 2, but with frequency
contours plotted as points over each spectrogram. To fix the frequency
contour, click near the malaligned points to place them over the
frequency contour that you detect by eye. <code>tailor_sels</code> makes
a new <code>.csv</code> file in your working directory that merges your
original data frame (below, <code>Phae.hisnrt</code>) with the modified
frequency time series (below, <code>ff_df</code> with any modified
frequency values). To check that your manual tracing improved frequency
contours, you can use <code>track_freq_contour</code> to make
spectrograms with your new frequency contours plotted as custom
contours.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the original data frame of songs for the main tailor_sels dataset</span></span>
<span><span class="co"># the data frame with the fundamental frequency contours is provided for manual tracing</span></span>
<span><span class="fu"><a href="../reference/tailor_sels.html">tailor_sels</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>,</span>
<span>  wl <span class="op">=</span> <span class="fl">300</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, wn <span class="op">=</span> <span class="st">"hanning"</span>, mar <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  osci <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sound.files"</span>, <span class="st">"selec"</span><span class="op">)</span>, auto.contour <span class="op">=</span> <span class="cn">TRUE</span>, ts.df <span class="op">=</span> <span class="va">ff_df</span>, col <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># rename your tailor_sels output csv as desired, then read it back into R</span></span>
<span><span class="va">mff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"seltailor_output_mff.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mff</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/track_freq_contour.html">track_freq_contour</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>, it <span class="op">=</span> <span class="st">"jpeg"</span>, custom.contour <span class="op">=</span> <span class="va">mff</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="count-inflections-across-frequency-contours">Count inflections across frequency contours<a class="anchor" aria-label="anchor" href="#count-inflections-across-frequency-contours"></a>
</h3>
<p>This function calculates the modulation index for any frequency
contour or time series. The function <code>spectro_analysis</code> (see
below) also calculates a modulation index for signals, but as a single
value across the length of the signal.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_inf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inflections.html">inflections</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">df_df</span>, pb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df_inf</span><span class="op">)</span></span></code></pre></div>
<p>##<strong>Quantitative measurements of acoustic
(dis)similarity</strong></p>
</div>
<div class="section level3">
<h3 id="compare-methods-for-quantitative-analysis-of-signal-structure">Compare methods for quantitative analysis of signal structure<a class="anchor" aria-label="anchor" href="#compare-methods-for-quantitative-analysis-of-signal-structure"></a>
</h3>
<p>This section on <code>compare_methods</code> is taken directly from
<a href="https://marce10.github.io/2017/02/17/Choosing_the_right_method_for_measuring_acoustic_signal_structure.html" class="external-link">Marcelo
Araya-Salas’s bioacoustics blog</a> with slight modifications.</p>
<p>Bioacoustic research relies on quantifying the structure of acoustic
signals and comparing that structure across behavioral/ecological
contexts, groups or species. However, measuring signal structure in a
way that fully accounts for the variation in the signals could be a
tricky task. Some of the differences that are apparent by visual
inspection of spectrograms might not be picked up by some analyses.
Hence, choosing the most appropriate analytical approach is a critical
step.</p>
<p>The <code>warbleR</code> function <code>compare_methods</code>
attempts to facilitate method selection. This function produces graphs
(as image files in the working directory) with spectrograms from 4
signals that allow visual inspection of the performance of acoustic
analysis methods at comparing those signals. The signals are randomly
picked up from the provided data frame (<code>X</code> argument), and
the function compares 2 <code>warbleR</code>methods at a time. The
methods available are: * cross-correlation by warbleR function
<code>cross_correlation</code> * dynamic time warping on dominant or
fundamental frequency contours with <code>freq_DTW</code> * spectral
parameters with <code>spectro_analysis</code></p>
<p>In the last vignette, we tailored selections of <em>Phaethornis
longirostris</em> songs that were originally downloaded from
<em>xeno-canto</em>, detected by <code>auto_detec</code>and filtered by
signal-to-noise ratio (SNR). Here we will pick up the workflow with
these filtered and tailored selections, using the data frame
<code>Phae.hisnrt</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Phae.hisnrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Phae_hisnrt.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/compare_methods.html">compare_methods</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">Phae.hisnrt</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  wl <span class="op">=</span> <span class="fl">300</span>, n <span class="op">=</span> <span class="fl">10</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"XCORR"</span>, <span class="st">"dfDTW"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code>compare_methods</code> will produce 10 image files in the
working directory (since we specified <code>n = 10</code>) that look
like this:</p>
<!-- <center> ![`compare_methods` image example](comp.meth-XCORR-dfDTW-6-10-11-18.jpeg)</center> -->
<p> </p>
<p>In this graphic, the acoustic pairwise distance between signals is
shown next to the arrows linking them. The font color of a distance
value corresponds to the font color of the method that generated it, as
shown in the scatterplots (in this case black font represents XCORR
distances). Distances are standardized, with 0 being the distance of a
signal to itself and 1 the farthest pairwise distance in the pool of
signals. Principal Component Analysis (<code>princomp</code> function)
is applied to calculate distances when using spectral parameters (SP).
In this case, the first 2 PC’s are used. Classical Multidimensional
Scaling (also known as Principal Coordinates Analysis,
<code>cmdscale</code> function) is used for all other methods. The image
file name contains the methods being compared and the row number of the
selections. This function internally uses a modified version of the
<code>spectro</code> function from the <code>seewave</code> package to
create spectrograms. Note that the spectrograms are all plotted with the
same frequency and time scales.</p>
<p>Also note that the graphs contain 2 scatterplots (1 per method) of
the acoustic space of all signals in the input data frame
<code>X</code>. The position of the 4 signals in the spectrograms is
highlighted in the acoustic space scatterplot. These graphics allow you
to directly assess if the distances between signals in the acoustic
space accurately represent the spectrographic similarity (e.g. how
similar their acoustic structure looks in the spectrograms).</p>
<p>You can run <code>compare_methods</code> for any combination of the
quantitative methods for assessing acoustic (dis)similarity mentioned
above. Importantly, to include the SP method (spectral parameters
measured by the function <code>spectro_analysis</code>), you need a
large enough dataset, as the PCA that summarizes the spectral parameters
needs more units (rows) that variables (columns).</p>
</div>
<div class="section level3">
<h3 id="measure-acoustic-parameters-with-spectro_analysis">Measure acoustic parameters with spectro_analysis<a class="anchor" aria-label="anchor" href="#measure-acoustic-parameters-with-spectro_analysis"></a>
</h3>
<p>We can now perform acoustic measurements with the function
<code>spectro_analysis</code>. This function relies on the temporal
coordinates in selection tables to measure 29 parameters across
selections. <code>spectro_analysis</code> is a batch process that is
faster than calculating measurements manually, e.g. one selection and
recording at a time. <code>spectro_analysis</code> uses and customizes
several functions available in the <a href="https://cran.r-project.org/package=seewave" class="external-link"><code>seewave package</code></a>.</p>
<p>Use the bandpass filter to your advantage here, to filter out low or
high background noise before performing measurements. Also note that
changing the amplitude threshold will change the amplitude at which
noises (including non-target signals) are detected for measurements.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spectro_analysis.html">spectro_analysis</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">params</span>, <span class="st">"acoustic_parameters.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Remove parameters derived from fundamental frequency (based on
<code>track_freq_contour</code> results).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"fun|peakf"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-acoustic-parameters-by-song-type">Calculate acoustic parameters by song type<a class="anchor" aria-label="anchor" href="#calculate-acoustic-parameters-by-song-type"></a>
</h3>
<p>In addition to calculating acoustic parameters per individual signals
using <code>spectro_analysis</code>, you can also calculate these
acoustic parameters by song type (average, minimum and maximum values
per song type group).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phae.long1"</span>, <span class="st">"Phae.long2"</span>, <span class="st">"Phae.long3"</span>, <span class="st">"Phae.long4"</span>, <span class="st">"selec.table"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long1</span>, <span class="st">"Phae.long1.wav"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long2</span>, <span class="st">"Phae.long2.wav"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long3</span>, <span class="st">"Phae.long3.wav"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html" class="external-link">writeWave</a></span><span class="op">(</span><span class="va">Phae.long4</span>, <span class="st">"Phae.long4.wav"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a 'song' column</span></span>
<span><span class="va">selec.table</span><span class="op">$</span><span class="va">song</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Measure acoustic parameters</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spectro_analysis.html">spectro_analysis</a></span><span class="op">(</span><span class="va">selec.table</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">)</span>, <span class="fl">300</span>, fast <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add song data</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sp</span>, <span class="va">selec.table</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sound.files"</span>, <span class="st">"selec"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Caculate song-level parameters for all numeric parameters</span></span>
<span><span class="va">sng</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/song_analysis.html">song_analysis</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">sp</span>, song_colm <span class="op">=</span> <span class="st">"song"</span>, parallel <span class="op">=</span> <span class="fl">1</span>, pb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sng</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-time-warping-of-frequency-contours">Dynamic time warping of frequency contours<a class="anchor" aria-label="anchor" href="#dynamic-time-warping-of-frequency-contours"></a>
</h3>
<p>This section on dynamic time warping methods is taken directly from
<a href="https://marce10.github.io/2016/09/12/Similarity_of_acoustic_signals_with_dynamic_time_warping_(DTW).html" class="external-link">Marcelo
Araya-Salas’s bioacoustics blog</a> with slight modifications.</p>
<p>The dynamic time warping methods in <code>warbleR</code> all rely on
functions from the <code>dtw</code> package, and are available for both
dominant and fundamental frequencies. <code>df_DTW</code> and
<code>ff_DTW</code> calculate the dominant and fundamental frequency
contours, respectively, of each signal and compares using dynamic time
warping. You can interpolate measurements across the frequency time
series using the <code>length.out</code> argument.</p>
<p>These functions return a matrix of pairwise acoustic dissimilarity
(e.g. acoustic “distance”) measurements that can be used in analyses of
acoustic similarity, as well as image files with the frequency contours
plotted over the spectrograms. If you require only the time series
without the dynamic time warping analysis for either the dominant or
fundamental frequency, check out the functions <code>freq_ts</code>and
<code>freq_ts</code>.</p>
<p>Note that as the <code>freq_range</code> and
<code>freq_range_detec</code> functions, the dynamic time warping
functions tend to work best on more tonal signals. Check out the
resulting image files in your working directory.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Harmonic Phaethornis signals</span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/freq_DTW.html">freq_DTW</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, length.out <span class="op">=</span> <span class="fl">30</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span><span class="op">)</span>, wl <span class="op">=</span> <span class="fl">300</span>, img <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tonal Tinamou signals</span></span>
<span><span class="va">Tin.sels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Tinamus-major-154191_sels.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/freq_DTW.html">freq_DTW</a></span><span class="op">(</span><span class="va">Tin.sels</span>, length.out <span class="op">=</span> <span class="fl">30</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>, bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>, wl <span class="op">=</span> <span class="fl">512</span>, img <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span></code></pre></div>
<p>Check out <a href="https://marce10.github.io/2016/09/12/Similarity_of_acoustic_signals_with_dynamic_time_warping_(DTW).html" class="external-link">Marcelo’s
blog</a> for a great example of how to evaluate whether or not the
dynamic time warping (dis)similarity measurements accurately represents
acoustic differences.</p>
</div>
<div class="section level3">
<h3 id="spectrographic-cross-correlation">Spectrographic cross-correlation<a class="anchor" aria-label="anchor" href="#spectrographic-cross-correlation"></a>
</h3>
<p>Cross-correlation calculates the pairwise similarity of multiple
signals by spectrogram cross-correlation. <code>cross_correlation</code>
calculates a correlation of the amplitude values at each step by sliding
one spectrogram over the other. This function is a modified version of
the <code>corMatch</code> and <code>makeTemplate</code> functions from
the package <code>monitoR</code>. <code>cross_correlation</code> runs
over multiple signals and returns a list of output, including:</p>
<ul>
<li>a correlation statistic for each “sliding” step</li>
<li>the maximum (peak) correlation for each pairwise comparison</li>
</ul>
<p><code>cross_correlation</code> requires margins half the duration of
the signal on either side of the signal (e.g. before and after the start
and end coordinates). Signals that are very close to either the start or
end of a recording may throw errors. Additionally, when sound files have
been modified by bandpass filters, some pairwise cross-correlations may
not work and the correlation matrix may contain <code>NA</code> values.
<code>cross_correlation</code> now contains an argument to remove
columns of the matrix that contain <code>NA</code> values, which will
reduce the data in the matrix but also allow the matrix to be used in
subsequent analyses.</p>
<p>Here our output is a matrix of peak correlation per pairwise
comparison, with the recording-selection names as the matrix dimension
names.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_correlation.html">cross_correlation</a></span><span class="op">(</span><span class="va">Phae.hisnrt</span>, wl <span class="op">=</span> <span class="fl">300</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">xc</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-geographic-variation-using-spectro_analysis-measurements">Analysis of geographic variation using <code>spectro_analysis</code>
measurements<a class="anchor" aria-label="anchor" href="#analysis-of-geographic-variation-using-spectro_analysis-measurements"></a>
</h2>
<p>We can evaluate whether or not the observed variation in song
structure is reflected by the meters we just measured. For this we will
conduct a Principal Component Analysis on scaled (z-transformed) meters
and look at the grouping of songs (data points) in the scatter plot.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the PCA with only numeric variables of params</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">params</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">params</span>, <span class="va">is.numeric</span><span class="op">)</span><span class="op">]</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check loadings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pca</span><span class="op">)</span></span></code></pre></div>
<pre><code>Importance of components:
                         PC1    PC2    PC3     PC4     PC5     PC6    PC7     PC8     PC9    PC10    PC11    PC12    PC13   PC14    PC15    PC16
Standard deviation     3.799 2.6465 1.7684 1.01130 0.93681 0.88418 0.8449 0.72613 0.63069 0.52078 0.44692 0.43914 0.41945 0.3552 0.23923 0.18924
Proportion of Variance 0.481 0.2335 0.1042 0.03409 0.02925 0.02606 0.0238 0.01758 0.01326 0.00904 0.00666 0.00643 0.00586 0.0042 0.00191 0.00119
Cumulative Proportion  0.481 0.7145 0.8187 0.85280 0.88205 0.90811 0.9319 0.94948 0.96274 0.97178 0.97844 0.98487 0.99073 0.9949 0.99685 0.99804
                          PC17    PC18    PC19    PC20    PC21    PC22      PC23
Standard deviation     0.15921 0.15130 0.07228 0.05806 0.03699 0.02449 2.227e-15
Proportion of Variance 0.00084 0.00076 0.00017 0.00011 0.00005 0.00002 0.000e+00
Cumulative Proportion  0.99888 0.99965 0.99982 0.99993 0.99998 1.00000 1.000e+00</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract PCA scores</span></span>
<span><span class="va">pcascor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pca</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the 2 first PCs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pcascor</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sound.files</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"PC1"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add recordings/individuals labels</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">params</span><span class="op">$</span><span class="va">sound.files</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">params</span><span class="op">$</span><span class="va">sound.files</span>, <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".wav"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sound.files</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, split <span class="op">=</span> <span class="st">"-"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span>, USE.NAMES <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">labs</span>, cex <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p><img src="warbleR_workflow_03_files/figure-html/unnamed-chunk-30-1.png" width="1604.16666666667"></p>
<p>Songs are grouped by sound file. As each sound file represents a
single individual, this suggests that songs have individual signatures.
Let’s look at the song type level. First, we need to classify the songs
by song type. We can check the spectrograms we previously created to do
this.</p>
<!-- <center> ![song types](song_types_spectros.jpg)</center> -->
<p> </p>
<p>Songs from sound files 154070 and 154072 seem to belong to the same
song type. Sound files 154129 and 154161 represent a different song
type. Finally, the songs from each of the other 2 sound files have a
unique structure, so each one represents a different song type. Sound
file 154123 is represented here too, but in vignette 1 we decided
against using signals from this recording. We can add this information
to the plot by using symbols to represent song types.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a song type variable</span></span>
<span></span>
<span><span class="co"># First, extract recording ID</span></span>
<span><span class="va">songtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".wav"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sound.files</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, split <span class="op">=</span> <span class="st">"-"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span>, USE.NAMES <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now change IDs for letters representing song types</span></span>
<span><span class="va">songtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"154070|154072"</span>, <span class="st">"A"</span>, <span class="va">songtype</span><span class="op">)</span></span>
<span><span class="va">songtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"154129|154161"</span>, <span class="st">"B"</span>, <span class="va">songtype</span><span class="op">)</span></span>
<span><span class="va">songtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"154138"</span>, <span class="st">"C"</span>, <span class="va">songtype</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add song type as a variable representing symbol type</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pcascor</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sound.files</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">songtype</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"PC1"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add song type labels</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">songtype</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">pcascor</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">songtype</span>, <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">songtype</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="warbleR_workflow_03_files/figure-html/unnamed-chunk-31-1.png" width="1604.16666666667"></p>
<p>Songs of the same song type are more similar (they cluster together).
This PCA confirms that the visually obvious differences in the song
structures are well described by the meters measured in <a href="https://cran.r-project.org/package=warbleR" class="external-link"><code>warbleR</code></a>.
Likewise, it also confirms that we can detect biologically relevant
differences from sound files that have undergone <em>mp3</em>
compression and conversion back to <em>wav</em> format (see also
<a href="#References"> <sup>[2]</sup></a>). Importantly, if this
analysis were for publication we would have to run other filtering steps
on the acoustic parameters generated by <code>spectro_analysis</code>,
including removing any collinear variables.</p>
</div>
<div class="section level2">
<h2 id="coordinated-singing-analysis">Coordinated singing analysis<a class="anchor" aria-label="anchor" href="#coordinated-singing-analysis"></a>
</h2>
<p><code>warbleR</code> contains functions to visualize and test whether
or not singing bouts between individuals can be considered coordinated
singing. The function <code>plot_coordination</code> plots signals as
polygons to better visualize overlap between these signals.</p>
<p>The function <code>test_coordination</code> uses a Monte Carlo
randomization test to determine whether or not the probability of
finding overlapping songs in a singing event is less than or more than
what you would expect by chance. <code>test_coordination</code> can be
run simultaneously for many singing events, if all are contained in a
single data frame (see <code>test_coordination</code> documentation for
more information).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim_coor_sing</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sim_coor_sing</span><span class="op">)</span></span></code></pre></div>
<p>The <code>sim_coor_sing</code> dataset contains three types of
singing bouts:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save plots in a list</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coordination.html">plot_coordination</a></span><span class="op">(</span><span class="va">sim_coor_sing</span>, it <span class="op">=</span> <span class="st">"jpeg"</span>, img <span class="op">=</span> <span class="cn">FALSE</span>, res <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print list of plots to graphics device</span></span>
<span><span class="va">g</span></span></code></pre></div>
<p>We can test for overlapping or alternating coordinated singing using
the <code>less.than.chance</code> argument in
<code>test_coordination</code>. Here we will test for alternating
coordinated singing, since <code>less.than.chance</code> is set to
<code>TRUE</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_coordination.html">test_coordination</a></span><span class="op">(</span><span class="va">sim_coor_sing</span>, iterations <span class="op">=</span> <span class="fl">1000</span>, less.than.chance <span class="op">=</span> <span class="cn">TRUE</span>, cutoff <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulating-songs">Simulating songs<a class="anchor" aria-label="anchor" href="#simulating-songs"></a>
</h2>
<p>You can simulate songs using <code>warbleR</code>. Depending on your
question, you can simulate songs with different numbers of subunits,
subunit durations, numbers of harmonics, amplitudes, gaps between
subunits, amplitude fading of subunits, among other options. Songs are
simulated under Brownian motion frequency drift.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate a song with 3 tonal elements</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_songs.html">sim_songs</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, harms <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the simulated song</span></span>
<span><span class="co"># seewave::spectro(ss)</span></span>
<span></span>
<span><span class="co"># simulate a song with 3 harmonic elements of differing amplitude</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_songs.html">sim_songs</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, harms <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the simulated song</span></span>
<span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/spectro.html" class="external-link">spectro</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span></span></code></pre></div>
<p> </p>
<p>This vignette concludes the <code>warbleR</code> vignette series.
After running the code in this third vignette, you should now have an
idea of how to:</p>
<ul>
<li>measure frequency range of signals</li>
<li>extract spectral entropy and frequency contours as time series</li>
<li>manually fix frequency contours (as appropriate)</li>
<li>compare and choose methods for acoustic (dis)similarity
analysis</li>
<li>use different methods for acoustic (dis)similarity analysis
<ul>
<li>
<code>spectro_analysis</code>- 29 parameters (across signals or song
types)</li>
<li>
<code>freq_DTW</code> - dynamic time warping on frequency
contours</li>
<li>
<code>cross_correlation</code>- spectrographic
cross-correlation</li>
</ul>
</li>
<li>carry out steps for an analysis of geographic variation in
vocalizations</li>
<li>perform coordinated singing analysis</li>
<li>simulate songs for other research questions</li>
</ul>
<p>In these vignettes we presented examples of how the
<code>warbleR</code> functions can be used in a streamlined workflow for
flexible and rigorous bioacoustics analyses. The output of
<code>warbleR</code> functions can be used in other packages for
statistical analyses, such as machine learning.</p>
</div>
<div class="section level2">
<h2 id="citation">
<strong>Citation</strong><a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Please cite <code>warbleR</code> when you use the package:</p>
<p>Araya-Salas, M. and Smith-Vidaurre, G. (2017), warbleR: an R package
to streamline analysis of animal acoustic signals. Methods Ecol Evol. 8,
184-191.</p>
</div>
<div class="section level2">
<h2 id="reporting-bugs">
<strong>Reporting bugs</strong><a class="anchor" aria-label="anchor" href="#reporting-bugs"></a>
</h2>
<p>Please report any bugs <a href="https://github.com/maRce10/warbleR/issues" class="external-link">here</a>.  </p>
<p><font size="5"><a name="References">References</a></font></p>
<ol style="list-style-type: decimal">
<li>Araya-Salas, M. and G. Smith-Vidaurre. 2016. warbleR: an R package
to streamline analysis of animal acoustic signals. <em>Methods in
Ecology and Evolution</em>. doi: 10.1111/2041-210X.12624</li>
</ol>
<p> </p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  
</body>
</html>
