<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate animal vocalizations — simulate_songs • warbleR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Simulate animal vocalizations — simulate_songs"><meta name="description" content="simulate_songs simulate animal vocalizations in a wave object under brownian motion frequency drift."><meta property="og:description" content="simulate_songs simulate animal vocalizations in a wave object under brownian motion frequency drift."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">warbleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.34</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/a_warbleR.html">&lt;font size="7"&gt;&lt;b&gt;Introduction to warbleR&lt;/b&gt;&lt;/font&gt;</a></li>
    <li><a class="dropdown-item" href="../articles/b_annotation_data_format.html">Annotation data format</a></li>
    <li><a class="dropdown-item" href="../articles/c_warbleR_workflow_02.html">Visual inspection and signal classification</a></li>
    <li><a class="dropdown-item" href="../articles/d_warbleR_workflow_03.html">Acoustic (dis)similarity, coordinated singing and simulating songs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maRce10/warbleR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate animal vocalizations</h1>
      <small class="dont-index">Source: <a href="https://github.com/maRce10/warbleR/blob/master/R/simulate_songs.R" class="external-link"><code>R/simulate_songs.R</code></a></small>
      <div class="d-none name"><code>simulate_songs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>simulate_songs</code> simulate animal vocalizations in a wave object under brownian motion frequency drift.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_songs</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  durs <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  harms <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  harm.amps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  am.amps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gaps <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  freqs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  samp.rate <span class="op">=</span> <span class="fl">44.1</span>,</span>
<span>  sig2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bgn <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diff.fun <span class="op">=</span> <span class="st">"GBM"</span>,</span>
<span>  fin <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  fout <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  selec.table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  file.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hrm.freqs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">9</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>  freq.range <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of song subunits (e.g. elements). Default is 1.</p></dd>


<dt id="arg-durs">durs<a class="anchor" aria-label="anchor" href="#arg-durs"></a></dt>
<dd><p>Numeric vector with the duration of subunits in seconds. It should either be a single value (which would
be used for all subunits) or a vector of length <code>n</code>.</p></dd>


<dt id="arg-harms">harms<a class="anchor" aria-label="anchor" href="#arg-harms"></a></dt>
<dd><p>NUmeric vector of length 1 specifying the number of harmonics to simulate. 1 indicates that only the fundamental
frequency harmonic will be simulated.</p></dd>


<dt id="arg-harm-amps">harm.amps<a class="anchor" aria-label="anchor" href="#arg-harm-amps"></a></dt>
<dd><p>Numeric vector with the relative amplitude of each of the harmonics (including the fundamental frequency).</p></dd>


<dt id="arg-am-amps">am.amps<a class="anchor" aria-label="anchor" href="#arg-am-amps"></a></dt>
<dd><p>Numeric vector with the relative amplitude for each step (see 'step' argument) to simulate amplitude modulation (only applied to the fundamental frequency). Should have the same length as the number of steps. Default is 1 (no amplitude modulation).</p></dd>


<dt id="arg-gaps">gaps<a class="anchor" aria-label="anchor" href="#arg-gaps"></a></dt>
<dd><p>Numeric vector with the duration of gaps (silence between subunits) in seconds. It should either be a single value
(which would be used for all subunits) or a vector  of length <code>n + 1</code>.</p></dd>


<dt id="arg-freqs">freqs<a class="anchor" aria-label="anchor" href="#arg-freqs"></a></dt>
<dd><p>Numeric vector with the initial frequency of the subunits (and ending frequency if <code>diff.fun == "BB"</code>) in kHz.
It should either be a single value (which would  be used for all subunits) or a vector of length <code>n</code>.</p></dd>


<dt id="arg-samp-rate">samp.rate<a class="anchor" aria-label="anchor" href="#arg-samp-rate"></a></dt>
<dd><p>Numeric vector of length 1. Sets the sampling frequency of the wave object (in kHz). Default is 44.1.</p></dd>


<dt id="arg-sig-">sig2<a class="anchor" aria-label="anchor" href="#arg-sig-"></a></dt>
<dd><p>Numeric vector defining the sigma value of the brownian motion model. It should either be a single value
 (which would be used for all subunits) or a vector of length <code>n + 1</code>.  Higher values will produce faster
frequency modulations. Only applied if <code>diff.fun == "GBM"</code>. Default is 0.1. Check the <code><a href="https://rdrr.io/pkg/Sim.DiffProc/man/ABM.html" class="external-link">GBM</a></code> function from the Sim.DiffProc package
for more details.</p></dd>


<dt id="arg-steps">steps<a class="anchor" aria-label="anchor" href="#arg-steps"></a></dt>
<dd><p>Numeric vector of length 1. Controls the mean number of segments in which each song subunit is split during
the brownian motion process. If not all subunits have the same duration, longer units will be split in more steps (although
the average duration subunit will have the predefined number of steps). Default is 10.</p></dd>


<dt id="arg-bgn">bgn<a class="anchor" aria-label="anchor" href="#arg-bgn"></a></dt>
<dd><p>Numeric vector of length 1 indicating the background noise level. 0 means no additional noise will 1 means
noise at the same amplitude than the song subunits. Default is 0.5.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Numeric vector of length 1. This allows users to get the same results in different runs (using <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> internally). Default is <code>NULL</code>.</p></dd>


<dt id="arg-diff-fun">diff.fun<a class="anchor" aria-label="anchor" href="#arg-diff-fun"></a></dt>
<dd><p>Character vector of length 1 controlling the function used to simulate the brownian motion process of
frequency drift across time. Only "BB", "GBM" and "pure.tone" are accepted at this time. Check the <code><a href="https://rdrr.io/pkg/Sim.DiffProc/man/ABM.html" class="external-link">GBM</a></code> function from the Sim.DiffProc package
for more details.</p></dd>


<dt id="arg-fin">fin<a class="anchor" aria-label="anchor" href="#arg-fin"></a></dt>
<dd><p>Numeric vector of length 1 setting the proportion of the sub-unit to fade-in amplitude (value between 0 and 1).
Default is 0.1. Note that 'fin' + 'fout' cannot be higher than 1.</p></dd>


<dt id="arg-fout">fout<a class="anchor" aria-label="anchor" href="#arg-fout"></a></dt>
<dd><p>Numeric vector of length 1 setting the proportion of the sub-unit to fade-out amplitude (value between 0 and 1).
Default is 0.2. Note that 'fin' + 'fout' cannot be higher than 1.</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>Character string of length 1 controlling the shape of in and out amplitude fading of the song sub-units
('fin' and 'fout'). "linear" (default), "exp" (exponential), and "cos" (cosine) are currently allowed.</p></dd>


<dt id="arg-selec-table">selec.table<a class="anchor" aria-label="anchor" href="#arg-selec-table"></a></dt>
<dd><p>Logical. If <code>TRUE</code> the function returns a list with two elements: 1) a data frame containing the start/end time, and bottom/top frequency of the sub-units and  2) the wave object containing the simulated songs. If <code>FALSE</code> (default) no objects are returned. Regardless of the value of this argument a .wav file is always saved in the working directory.</p></dd>


<dt id="arg-file-name">file.name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>Character string for naming the ".wav" file. Ignored if
'selec.table' is <code>FALSE</code>. If not provided the date-time stamp will be used.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Character string with the directory path where the sound file should be saved. Ignored if 'selec.table' is <code>FALSE</code>.
If <code>NULL</code> (default) then the current working directory is used.</p></dd>


<dt id="arg-hrm-freqs">hrm.freqs<a class="anchor" aria-label="anchor" href="#arg-hrm-freqs"></a></dt>
<dd><p>Numeric vector with the frequencies of the harmonics relative to the fundamental frequency. The default values are c(1/2, 1/3, 2/3, 1/4, 3/4, 1/5, 1/6, 1/7, 1/8, 1/9, 1/10).</p></dd>


<dt id="arg-freq-range">freq.range<a class="anchor" aria-label="anchor" href="#arg-freq-range"></a></dt>
<dd><p>Numeric vector of length 1 with the frequency range around the simulated frequency in which signals will modulate. Default is 4 which means that sounds will range +/- 2 kHz around the target frequency. If <code>NULL</code> the frequency range is not constrained.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A wave object containing the simulated songs. If 'selec.table' is <code>TRUE</code> the function saves the wave object as a '.wav' sound file in the working directory (or 'path') and returns a list including 1) a selection table with the start/end time, and bottom/top frequency of the sub-units and 2) the wave object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This functions uses a geometric (<code>diff.fun == "GBM"</code>) or Brownian bridge (<code>diff.fun == "BB"</code>) motion stochastic process to simulate modulation in animal vocalizations (i.e. frequency traces across time).
The function can also simulate pure tones (<code>diff.fun == "pure.tone"</code>, 'sig2' is ignored).
Several song subunits (e.g. elements) can be simulated as well as the corresponding harmonics. Modulated sounds are adjusted so the mean frequency of the frequency contour is equal to the target frequency supplied by the user.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Araya-Salas, M., &amp; Smith-Vidaurre, G. (2017). warbleR: An R package to streamline analysis of animal acoustic signals. Methods in Ecology and Evolution, 8(2), 184-191.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="query_xc.html">query_xc</a></code> for for downloading bird vocalizations from an online repository.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marcelo Araya-Salas (<a href="mailto:marcelo.araya@ucr.ac.cr">marcelo.araya@ucr.ac.cr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># simulate a song with 3 elements and no harmonics</span></span></span>
<span class="r-in"><span><span class="va">sm_sng</span> <span class="op">&lt;-</span> <span class="fu">simulate_songs</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, harms <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot spectro</span></span></span>
<span class="r-in"><span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/spectro.html" class="external-link">spectro</a></span><span class="op">(</span><span class="va">sm_sng</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate a song with 5 elements and 2 extra harmonics</span></span></span>
<span class="r-in"><span><span class="va">sm_sng2</span> <span class="op">&lt;-</span> <span class="fu">simulate_songs</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, harms <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot spectrogram</span></span></span>
<span class="r-in"><span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/spectro.html" class="external-link">spectro</a></span><span class="op">(</span><span class="va">sm_sng2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># six pure tones with frequency ranging form 4 to 6 and returning selection table</span></span></span>
<span class="r-in"><span><span class="va">sm_sng</span> <span class="op">&lt;-</span> <span class="fu">simulate_songs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">6</span>, harms <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1</span>, diff.fun <span class="op">=</span> <span class="st">"pure.tone"</span>,</span></span>
<span class="r-in"><span>  freqs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, selec.table <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot spectro</span></span></span>
<span class="r-in"><span><span class="fu">seewave</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/seewave/man/spectro.html" class="external-link">spectro</a></span><span class="op">(</span><span class="va">sm_sng</span><span class="op">$</span><span class="va">wave</span>, flim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># selection table</span></span></span>
<span class="r-in"><span><span class="va">sm_sng</span><span class="op">$</span><span class="va">selec.table</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcelo Araya-Salas, Grace Smith-Vidaurre.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

